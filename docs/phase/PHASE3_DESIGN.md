# Phase 3: 고동시성 (100+ VU) 멀티플렉싱 효과

## 목적

동시 접속자가 많아지면 HTTP/1.1은 커넥션 부족 문제가 발생한다.  
HTTP/2 기반 gRPC의 멀티플렉싱이 얼마나 효과적인지 검증한다.

## 가설

> "100명 이상 동시 접속 시 HTTP/1.1은 커넥션 풀 한계로 느려지고,  
> gRPC는 단일 연결에서 모든 요청을 처리하여 유리할 것이다"

## 배경 지식

### HTTP/1.1 커넥션 제한
- 브라우저 기본: 도메인당 6개 연결
- 서버 기본: Keep-Alive 연결 수 제한
- 100 VU가 동시 요청 시 → 연결 대기 발생

### HTTP/2 멀티플렉싱
- 단일 연결에서 수백 개 스트림 동시 처리
- Head-of-Line Blocking 없음
- 연결 설정 오버헤드 1회만 발생

## 테스트 시나리오

| 시나리오 | 설명 |
|---------|------|
| A | 50 VU - 기준선 |
| B | 100 VU - 중간 부하 |
| C | 200 VU - 고부하 |
| D | 500 VU - 스트레스 |

## 테스트 조건

| 항목 | 값 |
|------|-----|
| 페이로드 크기 | 10KB (적절한 중간값) |
| 동시 사용자 (VU) | 50 → 100 → 200 → 500 |
| 테스트 시간 | 각 30초 |

## 측정 포인트

1. **연결 수** - HTTP/1.1 vs HTTP/2 실제 연결 개수
2. **연결 대기 시간** - 커넥션 풀 대기 시간
3. **처리량 변화** - VU 증가에 따른 throughput 변화 곡선

## 예상 결과

| VU | HTTP/Binary | gRPC/Unary | 예상 |
|----|------------|------------|------|
| 50 | 빠름 | 비슷 | HTTP ≈ gRPC |
| 100 | 느려짐 | 유지 | gRPC 우위 시작 |
| 200 | 급락 | 약간 감소 | gRPC 압도 |
| 500 | 포화 | 감소 | gRPC 압도 |

## 실행 방법

```bash
cd scripts

# 전체 실행 (50, 100, 200, 500 VU)
./run-phase3.sh

# 개별 VU 테스트
VU_LIST="50" ./run-phase3.sh
VU_LIST="100" ./run-phase3.sh
VU_LIST="200" ./run-phase3.sh
VU_LIST="500" ./run-phase3.sh

# 개별 스크립트 실행
k6 run -e VUS=100 -e SIZE=10kb phase3/grpc-test.js
```

## 상태

🔄 **준비 완료**